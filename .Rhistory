count(species_scientific)
sv_c30 %>%
count(species_scientific)
library(vegan)
?diversity
#Pivoting data table to matrix for diversity metrics
sv_speciesmat <- sv_birds_trimmed %>%
group_by(species, species_scientific) %>%
count(species_scientific)
#Pivoting data table to matrix for diversity metrics
sv_speciesmat <- sv_birds_trimmed %>%
group_by(site, species_scientific) %>%
count(species_scientific)
View(sv_speciesmat)
#Pivoting data table to matrix for diversity metrics
sv_speciesmat <- sv_birds_trimmed %>%
group_by(site, species_scientific) %>%
count(species_scientific) %>%
pivot_wider(
names_from = species_scientific,
values_from = n) %>%
column_to_rownames("site")
View(sv_speciesmat)
sv_speciesmat <- sv_birds_trimmed %>%
group_by(site, species_scientific) %>%
count(species_scientific) %>%
pivot_wider(
names_from = species_scientific,
values_from = n,
values_fill = 0) %>%
column_to_rownames("site")
View(sv_speciesmat)
diversity(sv_speciesmat, index = "shannon",
MARGIN = 1, base = exp(1))
setwd("/Users/andersonsmith/Desktop/R/siempre_verde")
sv_birds_raw <- read_csv("./sv_birds_raw.csv")
#Cleaning tibble
sv_birds_trimmed <- sv_birds_raw %>%
drop_na(species_scientific, family) %>%
mutate(species_scientific = as_factor(species_scientific)) %>%
mutate(site = as_factor(site))
#Pivoting data table to matrix for diversity metrics
sv_speciesmat <- sv_birds_trimmed %>%
group_by(site, species_scientific) %>%
count(species_scientific) %>%
pivot_wider(
names_from = species_scientific,
values_from = n,
values_fill = 0) %>%
column_to_rownames("site")
diversity(sv_speciesmat, index = "shannon",
MARGIN = 1, base = exp(1))
install.packages("mapdata")
install.packages("maptools",
repos = "https://packagemanager.posit.co/cran/2023-10-13")
library (tidyverse)
library(maptools)
install.packages("maptools",
repos = "https://packagemanager.posit.co/cran/2023-10-13")
library(maptools)
geuk_lat <- c(45.6679, 44.0142447, 42.759, 41.576, 40.8968, 40.3700, 39.31141,
38.0228, 37.306988, 32.76158333, 32.038, 26.7171667,
29.134, 29.833, 31.392)
geuk_lon <- c(-61.8783, -69.5375049, -70.891, -70.639, -73.4341, -73.3014,
-74.2, -75.2144, -76.411197, -79.96671667, -81.048,
-80.078, -80.955, -80.955, -81.271)
geuk_dat <- data.frame(lat=geuk_lat, lon=geuk_lon)
#Map of US, Canada, and Mexico with sample sites included
usa <- map_data("usa")
canada <- map_data("worldHires", "Canada")
install.packages("maptools",
repos = "https://packagemanager.posit.co/cran/2023-10-13")
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.5)+
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
canada <- map_data("worldHires", "Canada")
?map_data()
canada <- map_data("canada")
namespace:maps
mexico <- map_data("worldHires", "Mexico")
library(mapdata)
mexico <- map_data("worldHires", "Mexico")
usa <- map_data("usa")
canada <- map_data("worldHires", "Canada")
mexico <- map_data("worldHires", "Mexico")
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.5)+
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
geuk_lat <- c(45.6679, 44.0142447, 42.759, 41.576, 40.8968, 40.3700, 39.31141,
38.0228, 35.903, 34.702, 34.175, 37.306988, 32.76158333, 32.038,
26.7171667, 29.134, 29.833, 31.392)
geuk_lon <- c(-61.8783, -69.5375049, -70.891, -70.639, -73.4341, -73.3014,
-74.2, -75.2144, -76.411197, -79.96671667, -81.048, -75.604,
-76.751, -77.932, -80.078, -80.955, -80.955, -81.271)
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
#Make df of all sampling points
geuk_lat <- c(45.6679, 44.0142447, 42.759, 41.576, 40.8968, 40.3700, 39.31141,
38.0228, 35.903, 34.702, 34.175, 37.306988, 32.76158333, 32.038,
26.7171667, 29.134, 29.833, 31.392)
geuk_lon <- c(-61.8783, -69.5375049, -70.891, -70.639, -73.4341, -73.3014,
-74.2, -75.2144, -76.411197, -79.96671667, -81.048, -75.604,
-76.751, -77.932, -80.078, -80.955, -80.955, -81.271)
geuk_dat <- data.frame(lat=geuk_lat, lon=geuk_lon)
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
geuk_lat <- c(45.6679, 44.0142447, 42.759, 41.576, 40.8968, 40.3700, 39.31141,
38.0228, 37.306988, 32.76158333, 32.038, 26.7171667,
29.134, 29.833, 31.392)
geuk_lon <- c(-61.8783, -69.5375049, -70.891, -70.639, -73.4341, -73.3014,
-74.2, -75.2144, -76.411197, -79.96671667, -81.048,
-80.078, -80.955, -80.955, -81.271)
geuk_dat <- data.frame(lat=geuk_lat, lon=geuk_lon)
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
geuk_lat <- c(45.6679, 44.0142447, 42.759, 41.576, 40.8968, 40.3700, 39.31141,
38.0228, 37.306988, 32.76158333, 32.038, 26.7171667,
29.134, 29.833, 31.392, 35.903, 34.702, 34.175)
geuk_lon <- c(-61.8783, -69.5375049, -70.891, -70.639, -73.4341, -73.3014,
-74.2, -75.2144, -76.411197, -79.96671667, -81.048,
-80.078, -80.955, -80.955, -81.271, -75.604, -76.751, -77.932)
geuk_dat <- data.frame(lat=geuk_lat, lon=geuk_lon)
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
geom_text(lat = 35.5, long = -70, text = "A") +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate(y = 35.5, x = -70, label = "A", size = 3) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -70, label = "A", size = 3) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -72.5, label = "A", size = 10) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -74, label = "A", size = 8) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -74, label = "A", size = 7.5) +
annotate("text", y = 41, x = -68, label = "B", size = 7.5) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -74, label = "A", size = 7.5) +
annotate("text", y = 41.5, x = -69, label = "B", size = 7.5) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -74, label = "A", size = 7) +
annotate("text", y = 41.5, x = -69, label = "B", size = 7) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
geuk_lat <- c(45.6679, 44.0142447, 42.759, 41.576, 40.8968, 40.3700, 39.31141,
38.0228, 37.306988, 32.76158333, 32.038, 26.7171667,
29.134, 29.833, 31.392, 35.903, 34.702, 34.175, 44.65069)
geuk_lon <- c(-61.8783, -69.5375049, -70.891, -70.639, -73.4341, -73.3014,
-74.2, -75.2144, -76.411197, -79.96671667, -81.048, -80.078,
-80.955, -80.955, -81.271, -75.604, -76.751, -77.932, -63.42344)
geuk_dat <- data.frame(lat=geuk_lat, lon=geuk_lon)
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -74, label = "A", size = 7) +
annotate("text", y = 41.5, x = -69, label = "B", size = 7) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -74, label = "A", size = 7) +
annotate("text", y = 41.5, x = -69, label = "B", size = 7) +
annotate("text", y = 42.1, x = -65.1, label = "C", size = 7)
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -74, label = "A", size = 7) +
annotate("text", y = 41.5, x = -69, label = "B", size = 7) +
annotate("text", y = 42.1, x = -65.1, label = "C", size = 7) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -74, label = "A", size = 7) +
annotate("text", y = 41.5, x = -69, label = "B", size = 7) +
annotate("text", y = 42.3, x = -65.4, label = "C", size = 7) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
NAmap <- ggplot() + geom_polygon(data = usa,
aes(x=long, y = lat, group = group),
fill = "white",
color = "black") +
geom_polygon(data = canada, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
geom_polygon(data = mexico, aes(x=long, y = lat, group = group),
fill = "white", color="black") +
coord_fixed(xlim = c(-81, -60),  ylim = c(25, 48), ratio = 1.1) +
geom_point(data = geuk_dat,
aes(x = lon,
y = lat),
color = "mediumorchid3",
size = 3.3)+
annotate("text", y = 35.5, x = -74, label = "A", size = 7) +
annotate("text", y = 41.5, x = -69, label = "B", size = 7) +
annotate("text", y = 42.5, x = -65.5, label = "C", size = 7) +
xlab("Longitude") +
ylab("Latitude") +
theme_minimal()
NAmap
#anderson
setwd("C:/Users/andersonsmith/Desktop/R/GitHub/geuk_mito")
#anderson
setwd("C:/Users/andersonsmith/Desktop/R/GitHub/geuk_mito")
setwd("~/Desktop/R/GitHub/geuk_mito")
alphageuk<-read.fas("allGeukSep4_done.fasta")
library(haplotypes)
alphageuk<-read.fas("allGeukSep4_done.fasta")
locations<-substr(alphageuk@seqnames,1,4)
truepops<-locations
GeukAMOVA<-pairPhiST(alphageuk,truepops,nperm=100,negatives=FALSE,indels="missing")
GeukAMOVA
